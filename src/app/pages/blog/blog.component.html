<div class="blog-container">
  <div class="search-section">
    <h2>Полезная информация</h2>
    <div class="p-inputgroup">
      <input
        type="text"
        pInputText
        placeholder="Поиск по статьям..."
        (input)="onSearchInput($event)"
        [(ngModel)]="searchQuery"
        aria-label="Поиск по статьям"
      />
      <span
        class="p-inputgroup-addon"
        (click)="performSearch(searchQuery)"
        style="cursor: pointer;"
        title="Найти"
        role="button"
        tabindex="0"
        (keyup.enter)="performSearch(searchQuery)"
      >
        <i class="pi pi-search" aria-hidden="true"></i>
      </span>
    </div>
  </div>

  <p-progressSpinner *ngIf="isLoading" styleClass="blog-spinner"></p-progressSpinner>

  <div class="error-text" *ngIf="error && !isLoading">
    {{ error }}
  </div>

  <div class="search-info" *ngIf="!isLoading && searchQuery && filteredArticles.length === 0">
    <p>Ничего не найдено по запросу "{{ searchQuery }}"</p>
  </div>

  <div class="articles-grid" *ngIf="!isLoading && filteredArticles.length > 0">
    <p-card
      *ngFor="let article of filteredArticles; trackBy: trackById"
      [header]="article.title"
      [subheader]="formatDate(article.createdAt) + ' · ' + article.readingTime + ' мин.'"
      class="article-card"
      (click)="toggleExpand(article.id)"
      [class.is-expanded]="isExpanded(article.id)"
      [attr.aria-expanded]="isExpanded(article.id)"
      role="article"
    >
      <p class="preview">
        {{ article.previewText }}
      </p>

      <!-- основной текст статьи -->
      <div class="content" [attr.aria-hidden]="!isExpanded(article.id)">
        {{ article.content }}
      </div>

      <div class="tags" *ngIf="isExpanded(article.id) && article.tags?.length">
        <span class="tag" *ngFor="let tag of article.tags">{{ tag }}</span>
      </div>

      <ng-template pTemplate="footer">
        <div class="card-footer">
          <button
            pButton
            [label]="isExpanded(article.id) ? 'Свернуть' : 'Читать далее'"
            icon="pi pi-book"
            class="p-button-text"
            type="button"
            [attr.aria-expanded]="isExpanded(article.id)"
            (click)="$event.stopPropagation(); toggleExpand(article.id)"
          ></button>
        </div>
      </ng-template>
    </p-card>
  </div>
</div>
